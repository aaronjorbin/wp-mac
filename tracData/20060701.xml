<?xml version="1.0"?>
<rss xmlns:dc="http://purl.org/dc/elements/1.1/" version="2.0">
  <channel>
    <title>WordPress Trac</title>
    <link>http://core.trac.wordpress.org/timeline</link>
    <description>Trac Timeline</description>
    <language>en-US</language>
    <generator>Trac 1.2.2</generator>
    <image>
      <title>WordPress Trac</title>
      <url>http://core.trac.wordpress.org/chrome/site/your_project_logo.png</url>
      <link>http://core.trac.wordpress.org/timeline</link>
    </image>
    <item>
      <title>Ticket #2867 (MySQL 5.0.22 incompatibility) updated</title>
      
        <dc:creator>robmiller</dc:creator>

      <pubDate>Sat, 01 Jul 2006 20:56:21 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2867</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2867/1151787381000000</guid>
      <description>&lt;p&gt;
To clarify, this is an issue you should take to the support forum; it's a problem with your server/database rather than a defect in WP itself :)
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2890 (Editing comments converts line breaks to paragraph breaks) created</title>
      
        <dc:creator>jrawle</dc:creator>

      <pubDate>Sat, 01 Jul 2006 16:30:42 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2890</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2890/1151771442000000</guid>
      <description>&lt;p&gt;
When a comment is edited, any line breaks in the resulting comment are converted to paragraph breaks. Normally, a single newline is converted to BR and a double one to P. After editing, they all become new paragraphs.
&lt;/p&gt;
&lt;p&gt;
I have installed the WordPress 2.0.3 Tuneup plugin, but while fixing other comment editing bugs, it does not address this problem.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2870 (Make installation form pluggable (was: allow user to set password)) updated</title>
      
        <dc:creator>darkfate</dc:creator>

      <pubDate>Sat, 01 Jul 2006 14:31:29 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2870</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2870/1151764289000000</guid>
      <description>&lt;p&gt;
oops. I meant instead of asking the password AFTER install.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2870 (Make installation form pluggable (was: allow user to set password)) updated</title>
      
        <dc:creator>darkfate</dc:creator>

      <pubDate>Sat, 01 Jul 2006 14:30:57 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2870</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2870/1151764257000000</guid>
      <description>&lt;p&gt;
Instead of asking the password on install, why not put it in the form when you install. No sense having an extra redirect.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2866 (WP can't be used from a single source installation) updated</title>
      
        <dc:creator>darkfate</dc:creator>

      <pubDate>Sat, 01 Jul 2006 14:26:04 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2866</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2866/1151763964000000</guid>
      <description>&lt;p&gt;
Is it me, or is this basically WordPress MU.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2882 (wysiwyg editor html button not working) closed</title>
      
        <dc:creator>darkfate</dc:creator>

      <pubDate>Sat, 01 Jul 2006 14:22:07 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2882</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2882/1151763727000000</guid>
      <description>worksforme: &lt;p&gt;
Are you installing it from an automated install such as Fantastico? I know if you install wordpress from fantastico it has problems with the html. If you upload a copy by yourself and install it, it works fine. I have PHP 5 and it works. If you did upload it by yourself, make sure you uploaded all the files.
&lt;/p&gt;
</description>
      <category>closedticket</category>
    </item><item>
      <title>Ticket #2867 (MySQL 5.0.22 incompatibility) closed</title>
      
        <dc:creator>darkfate</dc:creator>

      <pubDate>Sat, 01 Jul 2006 14:13:09 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2867</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2867/1151763189000000</guid>
      <description>worksforme: &lt;p&gt;
Yea, I have the same version and it works for me
&lt;/p&gt;
</description>
      <category>closedticket</category>
    </item><item>
      <title>Ticket #2889 (duplicate content when submitting comments) created</title>
      
        <dc:creator>whooami</dc:creator>

      <pubDate>Sat, 01 Jul 2006 09:06:45 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2889</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2889/1151744805000000</guid>
      <description>&lt;p&gt;
An example of the problem is viewable on my brand new sandbox blog @ &lt;a class="ext-link" href="http://www.village-idiot.org/test-install/?p=1#comments"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://www.village-idiot.org/test-install/?p=1#comments&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;
That is a brand new install with NO plugins installed.
&lt;/p&gt;
&lt;p&gt;
Essentially what is happening is that link is being filtered twice and content is being added to the comment.
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
When you view the source for the second comment, you will notice that nofollow tags are changed - thats because I edited the make_clickable function and the wp_rel_nofollow function:
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;pre class="wiki"&gt;function wp_rel_nofollow( $text ) {
	$text = preg_replace('|&amp;lt;a (.+?)&amp;gt;|i', '&amp;lt;a $1 rel="nofollow-function"&amp;gt;', $text);
	return $text;
}
&lt;/pre&gt;&lt;pre class="wiki"&gt;function make_clickable($ret) {
	$ret = ' ' . $ret . ' ';
	$ret = preg_replace("#([\s&amp;gt;])(https?)://([^\s&amp;lt;&amp;gt;{}()]+[^\s.,&amp;lt;&amp;gt;{}()])#i", "$1&amp;lt;a href='$2://$3' rel='nofollow-clickable'&amp;gt;$2://$3&amp;lt;/a&amp;gt;", $ret);
	$ret = preg_replace("#(\s)www\.([a-z0-9\-]+)\.([a-z0-9\-.\~]+)((?:/[^ &amp;lt;&amp;gt;{}()\n\r]*[^., &amp;lt;&amp;gt;{}()\n\r]?)?)#i", "$1&amp;lt;a href='http://www.$2.$3$4' rel='nofollow-clickable'&amp;gt;www.$2.$3$4&amp;lt;/a&amp;gt;", $ret);
	$ret = preg_replace("#(\s)([a-z0-9\-_.]+)@([a-z0-9\-_.]+)\.([^,&amp;lt; \n\r]+)#i", "$1&amp;lt;a href=\"mailto:$2@$3.$4\"&amp;gt;$2@$3.$4&amp;lt;/a&amp;gt;", $ret);
	$ret = trim($ret);
	return $ret;
}
&lt;/pre&gt;&lt;p&gt;
Now the source for the link in question:
&lt;/p&gt;
&lt;pre class="wiki"&gt;&amp;lt;a href="http://www.test.com" rel="nofollow-function"&amp;gt;&amp;lt;a href='http://www.test.com' rel='nofollow-clickable'&amp;gt;http://www.test.com&amp;lt;/a&amp;gt;&amp;lt;/a&amp;gt;
&lt;/pre&gt;&lt;p&gt;
the comment I submitted was:
&lt;/p&gt;
&lt;pre class="wiki"&gt;&amp;lt;a href="http://www.test.com"&amp;gt;http://www.test.com&amp;lt;/a&amp;gt;
&lt;/pre&gt;&lt;p&gt;
Obviously thats not correct.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2791 (deleting comments, pages results in "you do not have permission to do that") updated</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Sat, 01 Jul 2006 05:57:13 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2791</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2791/1151733433000000</guid>
      <description>&lt;p&gt;
This may have been fixed since 2.0.3.
&lt;/p&gt;
&lt;p&gt;
That message is sent when an AJAX call can't complete due to lack of capabilities or if the cookies used in check_ajax_referer() aren't being delivered for some reason.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2887 (Load default localization domain before load plugins) updated</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Sat, 01 Jul 2006 05:53:37 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2887</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2887/1151733217000000</guid>
      <description>&lt;p&gt;
We load the textdomain after plugins are loaded so that plugins have the chance to modify the locale.  This change might break some localization plugins.
&lt;/p&gt;
&lt;p&gt;
Plugins shouldn't be invoking any gettext until after the init action.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2888 (New function to reset vars) updated</title>
      
        <dc:creator>robmiller</dc:creator>

      <pubDate>Sat, 01 Jul 2006 04:54:10 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2888</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2888/1151729650000000</guid>
      <description>&lt;p&gt;
Ha! I was just planning on doing this today. Nice work :)
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2887 (Load default localization domain before load plugins) updated</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 04:34:44 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2887</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2887/1151728484000000</guid>
      <description>&lt;p&gt;
Check &lt;a class="ext-link" href="http://dev.wp-plugins.org/ticket/439"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;#439 at WordPress Plugins Repository for Widgets plugin&lt;/a&gt;.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2791 (deleting comments, pages results in "you do not have permission to do that") updated</title>
      
        <dc:creator>JeremyVisser</dc:creator>

      <pubDate>Sat, 01 Jul 2006 04:34:34 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2791</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2791/1151728474000000</guid>
      <description>&lt;i&gt;Version&lt;/i&gt; changed&lt;br/&gt;</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2887 (Load default localization domain before load plugins) updated</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 04:27:30 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2887</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2887/1151728050000000</guid>
      <description>&lt;i&gt;Keywords&lt;/i&gt;, &lt;i&gt;Owner&lt;/i&gt; changed&lt;br/&gt;</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2888 (New function to reset vars) updated</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 04:21:04 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2888</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2888/1151727664000000</guid>
      <description>&lt;i&gt;Keywords&lt;/i&gt;, &lt;i&gt;Owner&lt;/i&gt; changed&lt;br/&gt;</description>
      <category>editedticket</category>
    </item><item>
      <title>wp_reset_vars.diff attached to Ticket #2888</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 04:01:53 GMT</pubDate>
      <link>http://core.trac.wordpress.org/attachment/ticket/2888/wp_reset_vars.diff</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/attachment/ticket/2888/wp_reset_vars.diff/1151726513830000</guid>
      <description></description>
      <category>attachment</category>
    </item><item>
      <title>Ticket #2888 (New function to reset vars) created</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 03:56:33 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2888</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2888/1151726193000000</guid>
      <description>&lt;p&gt;
Most files in wordpress/wp-admin/*.php start with 15-lines-code to reset vars in an array. So, just move this code to new function and put it in admin-functions.php. This is better than write same code in +10 files.
&lt;/p&gt;
&lt;p&gt;
In the patch i used $_REQUEST because it contain both of $_POST and $_GET, this will offer some lines. Also, the var unseted according to &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2595" title="#2595: defect (bug): Option of &amp;#34;action&amp;#34; with value &amp;#34;update&amp;#34; is being added to options table (closed: fixed)"&gt;#2595&lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;
Also, isn't "foreach" better than "for"? or at least more cleaner?
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2791 (deleting comments, pages results in "you do not have permission to do that") updated</title>
      
        <dc:creator>spencerp</dc:creator>

      <pubDate>Sat, 01 Jul 2006 03:44:24 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2791</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2791/1151725464000000</guid>
      <description>&lt;p&gt;
I just deleted numerous comments, and the About page twice, with and without javascript enabled, on the localhost 2.0.4-alpha test blog, and I have not yet seen that message.
&lt;/p&gt;
&lt;p&gt;
Is anyone else seeing this message: "you do not have permission to do that"? Because I'm not.. or maybe I'm missing something here..? As far as I know, this could/should be closed now. =)
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>wp-settings.php.diff attached to Ticket #2887</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 03:44:09 GMT</pubDate>
      <link>http://core.trac.wordpress.org/attachment/ticket/2887/wp-settings.php.diff</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/attachment/ticket/2887/wp-settings.php.diff/1151725449560000</guid>
      <description>&lt;p&gt;
Load default localization domain before load plugins
&lt;/p&gt;
</description>
      <category>attachment</category>
    </item><item>
      <title>Ticket #2887 (Load default localization domain before load plugins) created</title>
      
        <dc:creator>Sewar</dc:creator>

      <pubDate>Sat, 01 Jul 2006 03:39:19 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2887</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2887/1151725159000000</guid>
      <description>&lt;p&gt;
Some plugins uses localization after loaded (like Widgets), but default domain loaded after loading plugins. So, when this plugins try to use localization the text will not be translated and no error will occur.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2807 (can't delete comments) updated</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Sat, 01 Jul 2006 02:05:36 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2807</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2807/1151719536000000</guid>
      <description>&lt;p&gt;
(In &lt;a class="changeset" href="http://core.trac.wordpress.org/changeset/3945" title="Delete comment fix from tenpura. fixes #2807"&gt;[3945]&lt;/a&gt;) Delete comment fix from tenpura. fixes &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2807" title="#2807: defect (bug): can't delete comments (closed: fixed)"&gt;#2807&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Changeset [3945]: Delete comment fix from tenpura. fixes #2807</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Sat, 01 Jul 2006 02:05:34 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3945</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3945/1151719534875355</guid>
      <description>&lt;p&gt;
Delete comment fix from tenpura. fixes &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2807" title="#2807: defect (bug): can't delete comments (closed: fixed)"&gt;#2807&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Ticket #2807 (can't delete comments) closed</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Sat, 01 Jul 2006 02:03:22 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2807</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2807/1151719402000000</guid>
      <description>fixed: &lt;p&gt;
(In &lt;a class="changeset" href="http://core.trac.wordpress.org/changeset/3944" title="Delete comment fix from tenpura. fixes #2807"&gt;[3944]&lt;/a&gt;) Delete comment fix from tenpura. fixes &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2807" title="#2807: defect (bug): can't delete comments (closed: fixed)"&gt;#2807&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>closedticket</category>
    </item><item>
      <title>Changeset [3944]: Delete comment fix from tenpura. fixes #2807</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Sat, 01 Jul 2006 02:03:21 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3944</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3944/1151719401655392</guid>
      <description>&lt;p&gt;
Delete comment fix from tenpura. fixes &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2807" title="#2807: defect (bug): can't delete comments (closed: fixed)"&gt;#2807&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Ticket #2807 (can't delete comments) updated</title>
      
        <dc:creator>JeremyVisser</dc:creator>

      <pubDate>Sat, 01 Jul 2006 01:30:51 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2807</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2807/1151717451000000</guid>
      <description>&lt;i&gt;Keywords&lt;/i&gt; changed&lt;br/&gt;&lt;p&gt;
Confirmed - this patch fixes the problem for me. Tested on latest WP trunk (rev. 3943).
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2797 (Drag and Drop uploaded file URL breaks in Firefox 1.5.0.4) updated</title>
      
        <dc:creator>mindless</dc:creator>

      <pubDate>Fri, 30 Jun 2006 23:14:56 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2797</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2797/1151709296000000</guid>
      <description>&lt;p&gt;
Side note... this seems to only adversely affect wordpress installs inside a subfolder. Many people run wordpress in the root of their public directory, so make sure to test against a subfolder install before marking "worksforme". Completely reproduceable every time.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2797 (Drag and Drop uploaded file URL breaks in Firefox 1.5.0.4) updated</title>
      
        <dc:creator>mindless</dc:creator>

      <pubDate>Fri, 30 Jun 2006 23:07:12 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2797</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2797/1151708832000000</guid>
      <description>&lt;p&gt;
This was created in 2.0.2 release by this enhancement: &lt;a class="ext-link" href="http://trac.wordpress.org/ticket/2492"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://trac.wordpress.org/ticket/2492&lt;/a&gt;
&lt;/p&gt;
&lt;p&gt;
I have been editing that one line out of new WP installs for months now. Clearly, 2.0.2 was not merely a security update as advertised. Of the two additional "enhancements", this one does damage. :(
&lt;/p&gt;
&lt;p&gt;
Quick fix, just reverse the 2492 changeset and those wanting more intelligent processing of relative urls will have to get it another way.
&lt;/p&gt;
&lt;p&gt;
Sorry, I'm no expert at patches. Somebody make one?
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Changeset [3943]: Fix ref check.</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 22:17:07 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3943</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3943/1151705827695666</guid>
      <description>&lt;p&gt;
Fix ref check.
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Changeset [3942]: Fix ref check.</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 22:14:50 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3942</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3942/1151705690884062</guid>
      <description>&lt;p&gt;
Fix ref check.
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Ticket #2886 (Smilies don't get regognized properly, and they get substituted twice) created</title>
      
        <dc:creator>Anoyomouse</dc:creator>

      <pubDate>Fri, 30 Jun 2006 19:10:15 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2886</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2886/1151694615000000</guid>
      <description>&lt;p&gt;
The smilie replacement function has a problem that it can replace already-replaced strings because the str_replace function with array arguments does things linierally, this function (found in the php documentation under str_replace) makes this atomic, so replacements can't affect already replaced strings (see lots of comments in php docs for str_replace)
&lt;/p&gt;
&lt;p&gt;
attached is a patch to fix this error, as well as to sort the smilie list from biggest smily to smallest, so replacement "should" occour correctly
&lt;/p&gt;
&lt;p&gt;
this will patch the functions-formatted.php in the wp-includes directory
&lt;/p&gt;
&lt;p&gt;
--- functions-formatting-old.php        2006-05-26 15:27:00.000000000 +0000
+++ functions-formatting-new.php        2006-06-26 13:34:54.000000000 +0000
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
-583,6 +583,45 @@
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
return $text;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
}
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
+function rev_len_cmp($a, $b)
+{
+        if (strlen($a) == strlen($b)) {
+                if ($a == $b)
+                        return 0;
+                return $a &amp;lt; $b;
+        }
+        return (strlen($a) &amp;lt; strlen($b)) ? -1 : 1;
+}
+
+/&lt;strong&gt;
+ * same as str_replace (array, array, string), but changing only the text in the
+ * original string
+ * $search and $replace are arrays of strings, $subject is a string
+ */
+function str_replace_clean($search, $replace, $subject) {
+   if (!is_array($search) or !is_array($replace) or !is_string($subject)) return $subject;
+   while (count($search)) {
+       &lt;em&gt; get current terms, reduce the arrays for the next iteration
+       $search_text = array_shift($search);
+       $replace_text = array_shift($replace);
+       &lt;/em&gt; check if the substring is present
+       $pos = strpos($subject, $search_text);
+       if (is_int($pos)) {
+           &lt;em&gt; match found - break in pieces
+           $pieces = explode($search_text, $subject);
+           if (count($search)) { &lt;/em&gt; only if there are more substitutions to do
+               &lt;em&gt; make next substitutions in every piece of text between matches
+               foreach ($pieces as $k =&amp;gt; $v) {
+                   if (strlen($v)) $pieces[$k] = str_replace_clean($search, $replace, $v);
+               }
+           }
+           $subject = join($replace_text, $pieces);
+           break;
+       }
+   }
+   return $subject;
+}
+
&lt;/em&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
function convert_smilies($text) {
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
global $wp_smiliessearch, $wp_smiliesreplace;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
$output = &lt;em&gt;;
&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;
-590,12 +629,17 @@
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
&lt;em&gt; HTML loop taken from texturize function, could possible be consolidated
$textarr = preg_split("/(&amp;lt;.*&amp;gt;)/U", $text, -1, PREG_SPLIT_DELIM_CAPTURE); &lt;/em&gt; capture the tags as well as in between
$stop = count($textarr);&lt;em&gt; loop stuff
&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;p&gt;
+
+                $smil_ary = array_combine($wp_smiliessearch, $wp_smiliesreplace);
+                uksort($smil_ary, "rev_len_cmp");
+                $smil_ary = array_reverse($smil_ary);
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
for ($i = 0; $i &amp;lt; $stop; $i++) {
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
$content = $textarr[$i];
if ((strlen($content) &amp;gt; 0) &amp;amp;&amp;amp; ('&amp;lt;' != $content&lt;a class="missing report" title="report does not exist"&gt;{0}&lt;/a&gt;)) { &lt;em&gt; If it's not a tag
&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
&lt;ul&gt;&lt;li&gt;                               $content = str_replace($wp_smiliessearch, $wp_smiliesreplace, $content);
&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;
+                                $content = str_replace_clean(array_keys($smil_ary), array_values($smil_ary), $content, $count);
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
}
$output .= $content;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
+                        $content = &lt;em&gt;;
&lt;/em&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
}
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;
} else {
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
&lt;em&gt; return default text.
&lt;/em&gt;&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/blockquote&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2884 (When edit comment, random slashes appear in edited comment.) closed</title>
      
        <dc:creator>mdawaffe</dc:creator>

      <pubDate>Fri, 30 Jun 2006 17:05:21 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2884</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2884/1151687121000000</guid>
      <description>duplicate: &lt;p&gt;
Duplicate of &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2761" title="#2761: defect (bug): AYS Dialog adds slashes to quotes (closed: fixed)"&gt;#2761&lt;/a&gt;.
&lt;/p&gt;
&lt;p&gt;
See &lt;a class="ext-link" href="http://txfx.net/code/wordpress/wordpress-203-tuneup/"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://txfx.net/code/wordpress/wordpress-203-tuneup/&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>closedticket</category>
    </item><item>
      <title>Ticket #2885 (Add CSS for current page to wp_list_pages()) closed</title>
      
        <dc:creator>TigerDE2</dc:creator>

      <pubDate>Fri, 30 Jun 2006 14:41:14 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2885</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2885/1151678474000000</guid>
      <description>worksforme: &lt;p&gt;
Having tomatoes on my eyes. Sorry...
&lt;/p&gt;
</description>
      <category>closedticket</category>
    </item><item>
      <title>Ticket #2885 (Add CSS for current page to wp_list_pages()) created</title>
      
        <dc:creator>TigerDE2</dc:creator>

      <pubDate>Fri, 30 Jun 2006 14:38:23 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2885</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2885/1151678303000000</guid>
      <description>&lt;p&gt;
It would be nice if WP included a class for the current page when outputting wp_list_pages() to facilitate dynamic menu highlighting (see &lt;a class="ext-link" href="http://codex.wordpress.org/Dynamic_Menu_Highlighting"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;Codex&lt;/a&gt; for details.)
This bug is related to &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2437" title="#2437: enhancement: Add CSS classes to parents of the current item in the output of ... (closed: fixed)"&gt;#2437&lt;/a&gt;.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2884 (When edit comment, random slashes appear in edited comment.) created</title>
      
        <dc:creator>inetman2</dc:creator>

      <pubDate>Fri, 30 Jun 2006 12:59:35 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2884</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2884/1151672375000000</guid>
      <description>&lt;p&gt;
When I edit a comment left by a visitor, WP will enter random slashes into the edited comment.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2883 (allowed_tags() more semantic) created</title>
      
        <author>dave@…</author>

      <pubDate>Fri, 30 Jun 2006 10:27:15 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2883</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2883/1151663235000000</guid>
      <description>&lt;ul&gt;&lt;li&gt;File: template-functions-general.php
&lt;/li&gt;&lt;li&gt;Function: allowed_tags()
&lt;/li&gt;&lt;/ul&gt;&lt;p&gt;
The function allowed_tags() gereates a long line of tags which are allowed in comments.
&lt;/p&gt;
&lt;pre class="wiki"&gt;function allowed_tags() {
	global $allowedtags;
	$allowed = '';
	foreach ( $allowedtags as $tag =&amp;gt; $attributes ) {
		$allowed .= '&amp;lt;'.$tag;
		if ( 0 &amp;lt; count($attributes) ) {
			foreach ( $attributes as $attribute =&amp;gt; $limits ) {
				$allowed .= ' '.$attribute.'=""';
			}
		}
		$allowed .= '&amp;gt; ';
	}
	return htmlentities($allowed);
}
&lt;/pre&gt;&lt;p&gt;
This generates for example: &amp;lt;em&amp;gt; &amp;lt;i&amp;gt; &amp;lt;b&amp;gt; &amp;lt;strong&amp;gt; ...
&lt;/p&gt;
&lt;p&gt;
But imo, this should be an unordered list, so i modified the function:
&lt;/p&gt;
&lt;pre class="wiki"&gt;function allowed_tags() {
	global $allowedtags;
	$allowed = '';
	$pre = '&amp;lt;ul class="allowedtags"&amp;gt;';
	$end = '&amp;lt;/ul&amp;gt;';
	foreach ( $allowedtags as $tag =&amp;gt; $attributes ) {
		$allowed .= '&amp;lt;li&amp;gt;&amp;amp;lt;'.$tag;
		if ( 0 &amp;lt; count($attributes) ) {
			foreach ( $attributes as $attribute =&amp;gt; $limits ) {
				$allowed .= ' '.$attribute.'=""';
			}
		}
		$allowed .= '&amp;amp;gt;&amp;lt;/li&amp;gt;';
	}
	return $pre.$allowed.$end;
}
&lt;/pre&gt;&lt;p&gt;
Now, it generates this:
&lt;/p&gt;
&lt;p&gt;
&amp;lt;ul class="allowedtags"&amp;gt;
&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;
&amp;lt;li&amp;gt;&amp;amp;lt;em&amp;amp;gt;&amp;lt;/li&amp;gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;
&amp;lt;li&amp;gt;&amp;amp;lt;i&amp;amp;gt;&amp;lt;/li&amp;gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;
&amp;lt;li&amp;gt;&amp;amp;lt;strong&amp;amp;gt;&amp;lt;/li&amp;gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;
&amp;lt;li&amp;gt;&amp;amp;lt;b&amp;amp;gt;&amp;lt;/li&amp;gt;
&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;
&amp;lt;/ul&amp;gt;
&lt;/p&gt;
&lt;p&gt;
To make the whole thing html valid, change comments.php the allowed_tags part to:
&lt;/p&gt;
&lt;pre class="wiki"&gt;	&amp;lt;p&amp;gt;&amp;lt;strong&amp;gt;XHTML:&amp;lt;/strong&amp;gt; You can use these tags:&amp;lt;/p&amp;gt;
	&amp;lt;?php echo allowed_tags(); ?&amp;gt;
&lt;/pre&gt;&lt;p&gt;
Greetings
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2882 (wysiwyg editor html button not working) created</title>
      
        <dc:creator>kalvin</dc:creator>

      <pubDate>Fri, 30 Jun 2006 10:03:23 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2882</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2882/1151661803000000</guid>
      <description>&lt;p&gt;
in both IE and FF UNDER PHP 5 html butonn doent work at all and renders an image of a error 404 page istead of showing the code. it depends probably on the PHP version because on lower PHP releases it works fine
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2881 (XHTML CDATA Buglet) updated</title>
      
        <dc:creator>RuddO</dc:creator>

      <pubDate>Fri, 30 Jun 2006 09:56:16 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2881</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2881/1151661376000000</guid>
      <description>&lt;p&gt;
I agree with reporter in that this should actually be a filter.  Whether it should default to be included in the startup chain of filters... that's another matter.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2664 (Theme is irregularly reset to the default theme) updated</title>
      
        <dc:creator>oncidium</dc:creator>

      <pubDate>Fri, 30 Jun 2006 07:51:52 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2664</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2664/1151653912000000</guid>
      <description>&lt;p&gt;
I have been having the same problem.  I have removed all themes except for the one I would like to have as the active theme, so I think that will solve it for the time being.
&lt;/p&gt;
&lt;p&gt;
Odd problem though.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2773 (mysql server connections are being left open causing low system ...) reopened</title>
      
        <dc:creator>oncidium</dc:creator>

      <pubDate>Fri, 30 Jun 2006 07:48:44 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2773</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2773/1151653724000000</guid>
      <description></description>
      <category>reopenedticket</category>
    </item><item>
      <title>Ticket #2881 (XHTML CDATA Buglet) created</title>
      
        <dc:creator>aernative cel&lt;at&gt;web-engineer.co.uk</dc:creator>

      <pubDate>Fri, 30 Jun 2006 07:41:03 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2881</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2881/1151653263000000</guid>
      <description>&lt;p&gt;
wp-includes/template-functions-post.php file line 57 -
&lt;/p&gt;
&lt;p&gt;
$content = str_replace(']]&amp;gt;', ']]&amp;amp;gt;', $content);
&lt;/p&gt;
&lt;p&gt;
This line causes problem if any filters applied to content inject XHTML comments into your pages (for example script blocks...).
&lt;/p&gt;
&lt;p&gt;
Symanticly this feature should not exisit in this context as it is itself a kind of filter, If desired, it should be re-implimented as a filter so the user can choose to disable the feature.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2875 (https enclosures fail on post.) updated</title>
      
        <dc:creator>nigelkane</dc:creator>

      <pubDate>Fri, 30 Jun 2006 07:20:14 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2875</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2875/1151652014000000</guid>
      <description>&lt;p&gt;
wp_html_headers() does not support ssl either.
&lt;/p&gt;
&lt;p&gt;
at the current line 1073 the 2 lines setting the port should be re-writting:
&lt;/p&gt;
&lt;pre class="wiki"&gt;        $scheme = "";
        if ( $parts['scheme'] == "https" )
                $scheme = "ssl://";
        if ( !isset( $parts['port'] ) ) {
                if($scheme) {
                        $parts['port'] = 443;
                } else {
                        $parts['port'] = 80;
                }
        }
&lt;/pre&gt;&lt;p&gt;
You should not adjust the $host parameter as this is used in the HTML header commands and will break.
&lt;/p&gt;
&lt;p&gt;
You then should add the scheme into the fsockopen command:
&lt;/p&gt;
&lt;pre class="wiki"&gt;        $fp = @fsockopen($scheme.$host, $parts['port'], $err_num, $err_msg, 3);
&lt;/pre&gt;&lt;p&gt;
Still working on why this particular section is not being called.
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2418 (500 error when viewing site, no 500 error when viewing admin pages) updated</title>
      
        <author>chradil@…</author>

      <pubDate>Fri, 30 Jun 2006 04:10:30 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2418</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2418/1151640630000000</guid>
      <description>&lt;p&gt;
not sure if you've seen -
&lt;a class="ext-link" href="http://codex.wordpress.org/Using_Permalinks#Permalinks.2C_.htaccess.2C_and_MS_Frontpage"&gt;&lt;span class="icon"&gt;​&lt;/span&gt;http://codex.wordpress.org/Using_Permalinks#Permalinks.2C_.htaccess.2C_and_MS_Frontpage&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2878 (HTML Source Editor in Opera 9) updated</title>
      
        <dc:creator>JeremyVisser</dc:creator>

      <pubDate>Fri, 30 Jun 2006 01:26:35 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2878</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2878/1151630795000000</guid>
      <description>&lt;p&gt;
Exactly what version of WordPress does it occur with? Does it occur with the latest stable release (version 2.0.3)? Or does it occur with 2.1 alpha2?
&lt;/p&gt;
&lt;p&gt;
Is the "HTML source editor" referring to the HTML button in the graphical editor switched on by default?
&lt;/p&gt;
</description>
      <category>editedticket</category>
    </item><item>
      <title>Changeset [3941]: Use compact instead of long query string.</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 01:11:42 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3941</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3941/1151629902873036</guid>
      <description>&lt;p&gt;
Use compact instead of long query string.
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Changeset [3940]: Allow % so entities such as slashes don't break.</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 00:44:21 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3940</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3940/1151628261131092</guid>
      <description>&lt;p&gt;
Allow % so entities such as slashes don't break.
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Changeset [3939]: Allow % so entities such as slashes don't break.</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 00:43:23 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3939</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3939/1151628203557862</guid>
      <description>&lt;p&gt;
Allow % so entities such as slashes don't break.
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item><item>
      <title>Ticket #2879 (Cruft in TinyMCE translation) updated</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 00:24:16 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2879</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2879/1151627056000000</guid>
      <description>&lt;i&gt;Version&lt;/i&gt;, &lt;i&gt;Milestone&lt;/i&gt; changed&lt;br/&gt;</description>
      <category>editedticket</category>
    </item><item>
      <title>Ticket #2880 (After merging categories category_count does'nt increase) created</title>
      
        <dc:creator>jottlieb</dc:creator>

      <pubDate>Fri, 30 Jun 2006 00:10:42 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2880</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2880/1151626242000000</guid>
      <description>&lt;p&gt;
If I merge categories trough deleting one of them, the posts were moved correctly into the other category, but the post counter of this category does not increase.
The datebase field category_count does not increase although the are now new posts in it.
&lt;/p&gt;
</description>
      <category>newticket</category>
    </item><item>
      <title>Ticket #2879 (Cruft in TinyMCE translation) closed</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 00:07:31 GMT</pubDate>
      <link>http://core.trac.wordpress.org/ticket/2879</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/ticket/2879/1151626051000000</guid>
      <description>fixed: &lt;p&gt;
(In &lt;a class="changeset" href="http://core.trac.wordpress.org/changeset/3938" title="Get the foo out.  Props skeltoac.  fixes #2879"&gt;[3938]&lt;/a&gt;) Get the foo out.  Props skeltoac.  fixes &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2879" title="#2879: defect (bug): Cruft in TinyMCE translation (closed: fixed)"&gt;#2879&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>closedticket</category>
    </item><item>
      <title>Changeset [3938]: Get the foo out.  Props skeltoac.  fixes #2879</title>
      
        <dc:creator>ryan</dc:creator>

      <pubDate>Fri, 30 Jun 2006 00:07:30 GMT</pubDate>
      <link>http://core.trac.wordpress.org/changeset/3938</link>
      <guid isPermaLink="false">http://core.trac.wordpress.org/changeset/3938/1151626050656459</guid>
      <description>&lt;p&gt;
Get the foo out.  Props skeltoac.  fixes &lt;a class="closed ticket" href="http://core.trac.wordpress.org/ticket/2879" title="#2879: defect (bug): Cruft in TinyMCE translation (closed: fixed)"&gt;#2879&lt;/a&gt;
&lt;/p&gt;
</description>
      <category>changeset</category>
    </item>
   </channel>
</rss>